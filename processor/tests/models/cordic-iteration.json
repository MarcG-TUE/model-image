{
    "canvas": {
        "width": 275,
        "height": 180
    },
    "data": [
        ["parameters", [{
                "name": "iterations",
                "type": "range",
                "initialValue": 6,
                "description": "number of iterations",
                "step": 1,
                "range": [0, 10]
            },{
                "name": "alpha0",
                "type": "range",
                "initialValue": 20,
                "description": "initial angle",
                "step": 1,
                "range": [0, 360]
            },{
                "name": "angle",
                "type": "range",
                "initialValue": -65,
                "description": "rotation angle",
                "step": 1,
                "range": [-90, 90]
            }]
        ],
        ["variables", [
            {
                "name": "length1",
                "value": "1.35"
            },{
                "name": "length2",
                "value": "1.35"
            },{
                "name": "v1",
                "value": "[SceneData.variables.length1*Math.cos(SceneData.parameters.alpha0/180*Math.PI),SceneData.variables.length1*Math.sin(SceneData.parameters.alpha0/180*Math.PI)]",
                "updateOn": ["alpha0"]
            },{
                "name": "v2",
                "value": "[SceneData.variables.length2*Math.cos(SceneData.parameters.alpha0/180*Math.PI),SceneData.variables.length2*Math.sin(SceneData.parameters.alpha0/180*Math.PI)]",
                "updateOn": ["alpha0"]
            },{
                "name": "vf1",
                "value": "[SceneData.variables.length1*Math.cos((SceneData.parameters.alpha0+SceneData.parameters.angle)/180*Math.PI),SceneData.variables.length1*Math.sin((SceneData.parameters.alpha0+SceneData.parameters.angle)/180*Math.PI)]",
                "updateOn": ["alpha0", "angle"]
            },{
                "name": "vf2",
                "value": "[1/0.607*SceneData.variables.length2*Math.cos((SceneData.parameters.alpha0+SceneData.parameters.angle)/180*Math.PI),1/0.607*SceneData.variables.length2*Math.sin((SceneData.parameters.alpha0+SceneData.parameters.angle)/180*Math.PI)]",
                "updateOn": ["alpha0", "angle"]
            },{
                "name": "cordicOutput",
                "value": "SceneData.CordicRotate(SceneData.variables.v1, SceneData.parameters.angle/180*Math.PI, SceneData.parameters.iterations)",
                "updateOn": ["iterations", "angle", "alpha0"]
            },{
                "name": "cordicPseudoOutput",
                "value": "SceneData.CordicPseudoRotate(SceneData.variables.v2, SceneData.parameters.angle/180*Math.PI, SceneData.parameters.iterations)",
                "updateOn": ["iterations", "alpha0", "angle"]
            },{
                "name": "cordicVectors",
                "value": "SceneData.variables.cordicOutput.vectors",
                "updateOn": ["iterations", "alpha0", "angle"]
            },{
                "name": "cordicPseudoVectors",
                "value": "SceneData.variables.cordicPseudoOutput.vectors",
                "updateOn": ["iterations", "alpha0", "angle"]
            },{
                "name": "cordicArcs1",
                "value": "SceneData.variables.cordicOutput.arcs.map((a,i)=>{const radius = 1.2-0.6*Math.pow(2,-i); return (a[0]<=a[1])?{'start-angle': a[0]*180/Math.PI,'end-angle' : a[1]*180/Math.PI, radius,arrowHeads: 'end'}:{'start-angle': a[1]*180/Math.PI,'end-angle' : a[0]*180/Math.PI, radius,arrowHeads: 'begin'}})",
                "updateOn": ["iterations", "alpha0", "angle"]
            },{
                "name": "cordicArcs2",
                "value": "SceneData.variables.cordicOutput.arcs.map((a,i)=>{const radius = 1.5-0.8*Math.pow(2,-i); return (a[0]<=a[1])?{'start-angle': a[0]*180/Math.PI,'end-angle' : a[1]*180/Math.PI, radius,arrowHeads: 'end'}:{'start-angle': a[1]*180/Math.PI,'end-angle' : a[0]*180/Math.PI, radius,arrowHeads: 'begin'}})",
                "updateOn": ["iterations", "alpha0", "angle"]
            }
        ]]
    ],
    "elements": [
        [ "axis-2d", {
            "type": "4Q",
            "xDom": [-0.8,2.2],
            "yDom": [-2.2,2.2],
            "center": [40,90],
            "scale": 40,
            "options": {
                "tickValuesX": [1,2],
                "tickValuesY": [-2,-1,1,2]
            },
            "content": [
                ["vectors", {
                    "vectors": "SceneData.variables.cordicVectors.map(v=>{return {'p1': [0,0], 'p2': [v[0],v[1]]}})",
                    "attributes": {
                        "stroke": "#0000aa",
                        "stroke-width": 0.8
                    },
                    "updateOn": ["iterations", "alpha0", "angle"]
                }],
                ["vector",{
                    "p1": [0,0],
                    "p2": "SceneData.variables.v1",
                    "attributes": {
                        "stroke": "#00aa00",
                        "stroke-width": 0.8
                    },
                    "updateOn":["iterations", "alpha0", "angle"]
                }],
                ["vector",{
                    "p1": [0,0],
                    "p2": "SceneData.variables.vf1",
                    "attributes": {
                        "stroke": "#aa0000",
                        "stroke-width": 0.8
                    },
                    "updateOn":["iterations", "alpha0", "angle"]
                }],
                ["arcs", {
                    "arcs": "SceneData.variables.cordicArcs1",
                    "attributes": {
                        "stroke-dasharray": "5 1",
                        "stroke": "#ff0000",
                        "stroke-width": 0.6
                    },
                    "updateOn": ["iterations", "alpha0", "angle"]
                }]
            ]
        }],
        [ "axis-2d", {
            "type": "4Q",
            "xDom": [-0.8,2.2],
            "yDom": [-2.2,2.2],
            "center": [180,90],
            "scale": 40,
            "options": {
                "tickValuesX": [1,2],
                "tickValuesY": [-2,-1,1,2]
            },
            "content": [
                ["polyline", {
                    "points": "SceneData.variables.cordicPseudoVectors",
                    "attributes": {
                        "stroke": "#000000",
                        "stroke-width": 0.4,
                        "stroke-dasharray": "3 3"
                    },
                    "updateOn": ["iterations", "alpha0", "angle"]
                }],
                ["vectors", {
                    "vectors": "SceneData.variables.cordicPseudoVectors.map(v=>{return {'p1': [0,0], 'p2': [v[0],v[1]]}})",
                    "attributes": {
                        "stroke": "#0000aa",
                        "stroke-width": 0.8
                    },
                    "updateOn": ["iterations", "alpha0", "angle"]
                }],
                ["vector",{
                    "p1": [0,0],
                    "p2": "SceneData.variables.v1",
                    "attributes": {
                        "stroke": "#00aa00",
                        "stroke-width": 0.8
                    },
                    "updateOn":["iterations", "alpha0", "angle"]
                }],
                ["vector",{
                    "p1": [0,0],
                    "p2": "SceneData.variables.vf2",
                    "attributes": {
                        "stroke": "#aa0000",
                        "stroke-width": 0.8
                    },
                    "updateOn":["iterations", "alpha0", "angle"]
                }],
                ["arcs", {
                    "arcs": "SceneData.variables.cordicArcs2",
                    "attributes": {
                        "stroke-dasharray": "5 1",
                        "stroke": "#ff0000",
                        "stroke-width": 0.6
                    },
                    "updateOn": ["iterations", "alpha0", "angle"]
                }]
            ]
        }],
        ["latex-texts", {
            "texts": [
                {
                    "text": "{\\bf{}x}",
                    "position": [95,65],
                    "color": "#00aa00"
                },{
                    "text": "{\\bf{}x}",
                    "position": [235,65],
                    "color": "#00aa00"
                },{
                    "text": "{\\bf{}y}",
                    "position": [82,132],
                    "color": "#aa0000"
                },{
                    "text": "{\\bf{}y}",
                    "position": [247,157],
                    "color": "#aa0000"
                }
            ],
            "scale": 1
        }]
    ]
}